<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma Captcha - Gana Puntos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        h1 {
            color: #1a73e8;
            text-align: center;
            margin-bottom: 25px;
            font-size: 24px;
        }
        .puntos-seccion {
            background-color: #e8f0fe;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            text-align: center;
        }
        .puntos-seccion h2 {
            color: #1a73e8;
            font-size: 22px;
        }
        #puntos-usuario {
            font-size: 32px;
            font-weight: bold;
            color: #202124;
            margin-top: 5px;
        }
        .captcha-seccion {
            margin-bottom: 25px;
            text-align: center;
        }
        #captcha-imagen {
            max-width: 100%;
            height: auto;
            border: 1px solid #dadce0;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        #captcha-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #dadce0;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
        }
        #enviar-captcha {
            background-color: #1a73e8;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }
        #enviar-captcha:hover {
            background-color: #1557b0;
        }
        .estado-mensaje {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }
        .correcto {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .incorrecto {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Resuelve Captchas y Gana Puntos</h1>

        <!-- Sección de puntos del usuario -->
        <div class="puntos-seccion">
            <h2>Tus Puntos</h2>
            <div id="puntos-usuario">0</div>
        </div>

        <!-- Sección del captcha -->
        <div class="captcha-seccion">
            <img id="captcha-imagen" alt="Captcha a resolver">
            <input type="text" id="captcha-input" placeholder="Escribe el texto del captcha aquí">
            <button id="enviar-captcha">Enviar Respuesta</button>
            <div id="estado-mensaje" class="estado-mensaje"></div>
        </div>
    </div>

    <script>
        // Configuración de la API de RuCaptcha (usa tu clave API)
        const API_KEY = "7cebd0223d5f0e7642ec189d60eb68c7"; // TU API KEY AQUÍ
        let puntosUsuario = 0;
        let captchaIdActual = "";

        // Elementos del DOM
        const captchaImagen = document.getElementById("captcha-imagen");
        const captchaInput = document.getElementById("captcha-input");
        const enviarBtn = document.getElementById("enviar-captcha");
        const puntosUsuarioElem = document.getElementById("puntos-usuario");
        const estadoMensaje = document.getElementById("estado-mensaje");

        // Cargar nuevo captcha al iniciar
        window.onload = cargarNuevoCaptcha;

        // Función para cargar un captcha nuevo desde la API
        async function cargarNuevoCaptcha() {
            try {
                const respuesta = await fetch(`https://rucaptcha.com/in.php?key=${API_KEY}&action=getcaptcha`);
                const datos = await respuesta.json();
                
                if (datos.status === 1) {
                    captchaIdActual = datos.request;
                    captchaImagen.src = `https://rucaptcha.com/${datos.request}.png`;
                    limpiarEstado();
                } else {
                    mostrarEstado("Error al cargar captcha: " + datos.request, "incorrecto");
                }
            } catch (error) {
                mostrarEstado("Error de conexión con la API", "incorrecto");
            }
        }

        // Función para verificar la respuesta del captcha
        async function verificarCaptcha() {
            const respuestaUsuario = captchaInput.value.trim();
            if (!respuestaUsuario) {
                mostrarEstado("Escribe el texto del captcha primero", "incorrecto");
                return;
            }

            try {
                const respuesta = await fetch(`https://rucaptcha.com/res.php?key=${API_KEY}&action=get&id=${captchaIdActual}&json=1`);
                const datos = await respuesta.json();

                // Solo sumar puntos si la respuesta es correcta
                if (datos.status === 1 && datos.request === respuestaUsuario) {
                    puntosUsuario++;
                    puntosUsuarioElem.textContent = puntosUsuario;
                    mostrarEstado("¡Captcha correcto! +1 punto", "correcto");
                } else {
                    mostrarEstado("Captcha incorrecto, intenta de nuevo", "incorrecto");
                }

                // Cargar un nuevo captcha después de la verificación
                setTimeout(cargarNuevoCaptcha, 1500);
                captchaInput.value = "";
            } catch (error) {
                mostrarEstado("Error al verificar captcha", "incorrecto");
            }
        }

        // Función para mostrar mensajes de estado
        function mostrarEstado(texto, tipo) {
            estadoMensaje.textContent = texto;
            estadoMensaje.className = `estado-mensaje ${tipo}`;
        }

        // Limpiar mensaje de estado
        function limpiarEstado() {
            estadoMensaje.textContent = "";
            estadoMensaje.className = "estado-mensaje";
        }

        // Evento del botón enviar
        enviarBtn.addEventListener("click", verificarCaptcha);
        // Permitir enviar con tecla Enter
        captchaInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") verificarCaptcha();
        });
    </script>
</body>
</html>
